<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>MVP</title>
	<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
	<link href="https://api.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.css" rel="stylesheet">
	<script src="https://api.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.js"></script>
	<style>
		body {
			margin: 0px;
			border: 0px;
			padding: 0px;
		}

		#map {
			height: 500px;
			width: 90%;
		}

		#rust {
			height: 500px;
			width: 90%;
		}
	</style>
</head>

<body>
	<h1>Demo</h1>
	<div id="map"></div>
	<h2>widgetry here</h2>
	<div id="rust"></div>
	<h2>widgetry above</h2>
	<script type="module">
		import init, { run } from "./pkg/widgetry_demo.js";

		async function setup() {
			// Initialize the WASM function.
			await init();

			// TODO I feel like I probably just copied this from an example somewhere
			mapboxgl.accessToken = 'pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw';

			// Create the Mapbox map
			const map = new mapboxgl.Map({
				container: 'map',
				style: 'mapbox://styles/mapbox/streets-v11',
				center: [-97.74, 30.27],
				zoom: 13
			});

			map.on('load', () => {
				// This blocks, so do it after mapbox is live
				run("rust", "localhost", false);
			});
		}

		setup();
	</script>
</body>

</html>
